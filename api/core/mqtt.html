<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><meta http-equiv="X-UA-Compatible"content="IE=Edge"><meta http-equiv="Content-Type"content="text/html; charset=utf-8"><title>MQTT Client &#8212; esphomelib 1.6.2 documentation</title><link rel="stylesheet"href="../../_static/alabaster.css"type="text/css"><link rel="stylesheet"href="../../_static/pygments.css"type="text/css"><script src="../../_static/documentation_options.js"></script><script src="../../_static/jquery.js"></script><script src="../../_static/underscore.js"></script><script src="../../_static/doctools.js"></script><link rel="index"title="Index"href="../../genindex.html"><link rel="search"title="Search"href="../../search.html"><link rel="next"title="Over-The-Air Updates"href="ota.html"><link rel="prev"title="WiFi"href="wifi.html"><link rel="stylesheet"href="../../_static/custom.css"type="text/css"><meta name="viewport"content="width=device-width,initial-scale=0.9,maximum-scale=0.9"><div class="document"><div class="documentwrapper"><div class="bodywrapper"><div class="body"role="main"><div class="section"id="mqtt-client"><h1>MQTT Client<a class="headerlink"href="#mqtt-client"title="Permalink to this headline">¶</a></h1><div class="section"id="api-reference"><h2>API Reference<a class="headerlink"href="#api-reference"title="Permalink to this headline">¶</a></h2><div class="section"id="mqttclientcomponent"><h3>MQTTClientComponent<a class="headerlink"href="#mqttclientcomponent"title="Permalink to this headline">¶</a></h3><dl class="class"><dt id="_CPPv3N4mqtt19MQTTClientComponentE"><span id="_CPPv2N4mqtt19MQTTClientComponentE"></span><span id="mqtt::MQTTClientComponent"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component"></span><em class="property">class </em>mqtt<code class="descclassname">::</code><code class="descname">MQTTClientComponent</code><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="Permalink to this definition">¶</a><br><dd><p>Inherits from <a class="reference internal"href="component.html#class_component"><span class="std std-ref">Component</span></a><div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Public Functions<dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent19MQTTClientComponentERK15MQTTCredentials"><span id="_CPPv2N4mqtt19MQTTClientComponent19MQTTClientComponentERK15MQTTCredentials"></span><span id="mqtt::MQTTClientComponent::MQTTClientComponent__MQTTCredentialsCR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a430a22eac7df8380d610131e185588cf"></span>mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">MQTTClientComponent</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal"href="#_CPPv3N4mqtt15MQTTCredentialsE"title="mqtt::MQTTCredentials">MQTTCredentials</a> &amp;<em>credentials</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent19MQTTClientComponentERK15MQTTCredentials"title="Permalink to this definition">¶</a><br><dd></dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent13set_last_willERR11MQTTMessage"><span id="_CPPv2N4mqtt19MQTTClientComponent13set_last_willERR11MQTTMessage"></span><span id="mqtt::MQTTClientComponent::set_last_will__MQTTMessageRR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a7031e409b0b90d01df413cd5a152e60a"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">set_last_will</code><span class="sig-paren">(</span><a class="reference internal"href="#_CPPv3N4mqtt11MQTTMessageE"title="mqtt::MQTTMessage">MQTTMessage</a> &amp;&amp;<em>message</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent13set_last_willERR11MQTTMessage"title="Permalink to this definition">¶</a><br><dd><p>Set the last will testament message.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent17disable_last_willEv"><span id="_CPPv2N4mqtt19MQTTClientComponent17disable_last_willEv"></span><span id="mqtt::MQTTClientComponent::disable_last_will"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a5ef642fdab3ed8f2df1d9a3cc384d088"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">disable_last_will</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent17disable_last_willEv"title="Permalink to this definition">¶</a><br><dd><p>Remove the last will testament message.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent17set_birth_messageERR11MQTTMessage"><span id="_CPPv2N4mqtt19MQTTClientComponent17set_birth_messageERR11MQTTMessage"></span><span id="mqtt::MQTTClientComponent::set_birth_message__MQTTMessageRR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1ae22f933ed47ccbd84423d3b9f123aed0"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">set_birth_message</code><span class="sig-paren">(</span><a class="reference internal"href="#_CPPv3N4mqtt11MQTTMessageE"title="mqtt::MQTTMessage">MQTTMessage</a> &amp;&amp;<em>message</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent17set_birth_messageERR11MQTTMessage"title="Permalink to this definition">¶</a><br><dd><p>Set the birth message.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent21disable_birth_messageEv"><span id="_CPPv2N4mqtt19MQTTClientComponent21disable_birth_messageEv"></span><span id="mqtt::MQTTClientComponent::disable_birth_message"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a8b35bb1acabccd1a23f0470d6cc88e76"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">disable_birth_message</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent21disable_birth_messageEv"title="Permalink to this definition">¶</a><br><dd><p>Remove the birth message.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent14set_keep_aliveE8uint16_t"><span id="_CPPv2N4mqtt19MQTTClientComponent14set_keep_aliveE8uint16_t"></span><span id="mqtt::MQTTClientComponent::set_keep_alive__uint16_t"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a18b51c1ae9fdd8b567695950d3d7dcb3"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">set_keep_alive</code><span class="sig-paren">(</span>uint16_t <em>keep_alive_s</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent14set_keep_aliveE8uint16_t"title="Permalink to this definition">¶</a><br><dd><p>Set the keep alive time in seconds, every 0.7*keep_alive a ping will be sent.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent18set_discovery_infoERRNSt6stringEb"><span id="_CPPv2N4mqtt19MQTTClientComponent18set_discovery_infoERRNSt6stringEb"></span><span id="mqtt::MQTTClientComponent::set_discovery_info__ssRR.b"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a2e6766162399d0381a5e08a42d6bffab"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">set_discovery_info</code><span class="sig-paren">(</span>std::string &amp;&amp;<em>prefix</em>, bool <em>retain</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent18set_discovery_infoERRNSt6stringEb"title="Permalink to this definition">¶</a><br><dd><p>Set the Home Assistant discovery info.<p>See <a class="reference external"href="https://home-assistant.io/docs/mqtt/discovery/">MQTT Discovery</a>.<dl class="docutils"><dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">prefix</span></code>: The Home Assistant discovery prefix.<li><code class="docutils literal notranslate"><span class="pre">retain</span></code>: Whether to retain discovery messages.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3NK4mqtt19MQTTClientComponent18get_discovery_infoEv"><span id="_CPPv2NK4mqtt19MQTTClientComponent18get_discovery_infoEv"></span><span id="mqtt::MQTTClientComponent::get_discovery_infoC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a274503197b24454001c9dfa971eac917"></span><em class="property">const</em> <a class="reference internal"href="#_CPPv3N4mqtt17MQTTDiscoveryInfoE"title="mqtt::MQTTDiscoveryInfo">MQTTDiscoveryInfo</a> &amp;mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">get_discovery_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt19MQTTClientComponent18get_discovery_infoEv"title="Permalink to this definition">¶</a><br><dd><p>Get Home Assistant discovery info.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent17disable_discoveryEv"><span id="_CPPv2N4mqtt19MQTTClientComponent17disable_discoveryEv"></span><span id="mqtt::MQTTClientComponent::disable_discovery"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a6d7b52ce97f5d2e7852577570a620ba3"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">disable_discovery</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent17disable_discoveryEv"title="Permalink to this definition">¶</a><br><dd><p>Globally disable Home Assistant discovery.</dl><dl class="function"><dt id="_CPPv3NK4mqtt19MQTTClientComponent20is_discovery_enabledEv"><span id="_CPPv2NK4mqtt19MQTTClientComponent20is_discovery_enabledEv"></span><span id="mqtt::MQTTClientComponent::is_discovery_enabledC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a877f955f0bd36f3d15a374a6afc8cbc5"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">is_discovery_enabled</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt19MQTTClientComponent20is_discovery_enabledEv"title="Permalink to this definition">¶</a><br><dd></dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent13set_client_idENSt6stringE"><span id="_CPPv2N4mqtt19MQTTClientComponent13set_client_idENSt6stringE"></span><span id="mqtt::MQTTClientComponent::set_client_id__ss"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a5d81b59039fe0df119d8be572d9ffbbc"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">set_client_id</code><span class="sig-paren">(</span>std::string <em>client_id</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent13set_client_idENSt6stringE"title="Permalink to this definition">¶</a><br><dd><p>Manually set the client id, by default it’s &lt;name&gt;-&lt;MAC&gt;, it’s automatically truncated to 23 chars.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent19add_ssl_fingerprintERKNSt5arrayI7uint8_t9SHA1_SIZEEE"><span id="_CPPv2N4mqtt19MQTTClientComponent19add_ssl_fingerprintERKNSt5arrayI7uint8_t9SHA1_SIZEEE"></span><span id="mqtt::MQTTClientComponent::add_ssl_fingerprint__std::array:uint8_t.SHA1_SIZE:CR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a34760b695b2f86eb70c03f5cc7e4d901"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">add_ssl_fingerprint</code><span class="sig-paren">(</span><em class="property">const</em> std::array&lt;uint8_t, SHA1_SIZE&gt; &amp;<em>fingerprint</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent19add_ssl_fingerprintERKNSt5arrayI7uint8_t9SHA1_SIZEEE"title="Permalink to this definition">¶</a><br><dd><p>Add a SSL fingerprint to use for TCP SSL connections to the MQTT broker.<p>To use this feature you first have to globally enable the <code class="docutils literal notranslate"><span class="pre">ASYNC_TCP_SSL_ENABLED</span></code> define flag. This function can be called multiple times and any certificate that matches any of the provided fingerprints will match. Calling this method will also automatically disable all non-ssl connections.<p><dl class="docutils"><dt><strong>Warning</strong><dd>This is <em>not</em> secure and <em>not</em> how SSL is usually done. You’ll have to add a separate fingerprint for every certificate you use. Additionally, the hashing algorithm used here due to the constraints of the MCU, SHA1, is known to be insecure.<dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">fingerprint</span></code>: The SSL fingerprint as a 20 value long std::array.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent16get_availabilityEv"><span id="_CPPv2N4mqtt19MQTTClientComponent16get_availabilityEv"></span><span id="mqtt::MQTTClientComponent::get_availability"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a1fae8a359fb53eb46c2a874e76b3e000"></span><em class="property">const</em> <a class="reference internal"href="#_CPPv3N4mqtt12AvailabilityE"title="mqtt::Availability">Availability</a> &amp;mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">get_availability</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent16get_availabilityEv"title="Permalink to this definition">¶</a><br><dd></dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent16set_topic_prefixENSt6stringE"><span id="_CPPv2N4mqtt19MQTTClientComponent16set_topic_prefixENSt6stringE"></span><span id="mqtt::MQTTClientComponent::set_topic_prefix__ss"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1adb1c2d6ca6205feb5cc673c6cfbbac4f"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">set_topic_prefix</code><span class="sig-paren">(</span>std::string <em>topic_prefix</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent16set_topic_prefixENSt6stringE"title="Permalink to this definition">¶</a><br><dd><p>Set the topic prefix that will be prepended to all topics together with “/”.<p>This will, in most cases, be the name of your <a class="reference internal"href="application.html#class_application"><span class="std std-ref">Application</span></a>.<p>For example, if “livingroom” is passed to this method, all state topics will, by default, look like “livingroom/…/state”<p><dl class="docutils"><dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">topic_prefix</span></code>: The topic prefix. The last “/” is appended automatically.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3NK4mqtt19MQTTClientComponent16get_topic_prefixEv"><span id="_CPPv2NK4mqtt19MQTTClientComponent16get_topic_prefixEv"></span><span id="mqtt::MQTTClientComponent::get_topic_prefixC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1aac6d444129ee7e8d0c7bf13a96238e0a"></span><em class="property">const</em> std::string &amp;mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">get_topic_prefix</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt19MQTTClientComponent16get_topic_prefixEv"title="Permalink to this definition">¶</a><br><dd><p>Get the topic prefix of this device, using default if necessary.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent24set_log_message_templateERR11MQTTMessage"><span id="_CPPv2N4mqtt19MQTTClientComponent24set_log_message_templateERR11MQTTMessage"></span><span id="mqtt::MQTTClientComponent::set_log_message_template__MQTTMessageRR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a60b4cc8340e97333aba2efc381d3353e"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">set_log_message_template</code><span class="sig-paren">(</span><a class="reference internal"href="#_CPPv3N4mqtt11MQTTMessageE"title="mqtt::MQTTMessage">MQTTMessage</a> &amp;&amp;<em>message</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent24set_log_message_templateERR11MQTTMessage"title="Permalink to this definition">¶</a><br><dd><p>Manually set the topic used for logging.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent19disable_log_messageEv"><span id="_CPPv2N4mqtt19MQTTClientComponent19disable_log_messageEv"></span><span id="mqtt::MQTTClientComponent::disable_log_message"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a68d4fac1c384687b55d59fa19d780dfd"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">disable_log_message</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent19disable_log_messageEv"title="Permalink to this definition">¶</a><br><dd><p>Get the topic used for logging. Defaults to “&lt;topic_prefix&gt;/debug” and the value is cached for speed.</dl><dl class="function"><dt id="_CPPv3NK4mqtt19MQTTClientComponent22is_log_message_enabledEv"><span id="_CPPv2NK4mqtt19MQTTClientComponent22is_log_message_enabledEv"></span><span id="mqtt::MQTTClientComponent::is_log_message_enabledC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a9be0d3ea957c1341a2ed169d7e6d5cfe"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">is_log_message_enabled</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt19MQTTClientComponent22is_log_message_enabledEv"title="Permalink to this definition">¶</a><br><dd></dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent9subscribeERKNSt6stringE15mqtt_callback_t7uint8_t"><span id="_CPPv2N4mqtt19MQTTClientComponent9subscribeERKNSt6stringE15mqtt_callback_t7uint8_t"></span><span id="mqtt::MQTTClientComponent::subscribe__ssCR.mqtt_callback_t.uint8_t"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1aece1c389cb2d5fcff87e89ac01bddd2a"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">subscribe</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>topic</em>, mqtt_callback_t <em>callback</em>, uint8_t <em>qos</em> = 0<span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent9subscribeERKNSt6stringE15mqtt_callback_t7uint8_t"title="Permalink to this definition">¶</a><br><dd><p>Subscribe to an MQTT topic and call callback when a message is received.<p><dl class="docutils"><dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">topic</span></code>: The topic. Wildcards are currently not supported.<li><code class="docutils literal notranslate"><span class="pre">callback</span></code>: The callback function.<li><code class="docutils literal notranslate"><span class="pre">qos</span></code>: The QoS of this subscription.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent14subscribe_jsonERKNSt6stringE12json_parse_t7uint8_t"><span id="_CPPv2N4mqtt19MQTTClientComponent14subscribe_jsonERKNSt6stringE12json_parse_t7uint8_t"></span><span id="mqtt::MQTTClientComponent::subscribe_json__ssCR.json_parse_t.uint8_t"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a849bd7061cbc0ea8667565cd0f35202d"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">subscribe_json</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>topic</em>, <a class="reference internal"href="helpers.html#_CPPv312json_parse_t"title="json_parse_t">json_parse_t</a> <em>callback</em>, uint8_t <em>qos</em> = 0<span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent14subscribe_jsonERKNSt6stringE12json_parse_t7uint8_t"title="Permalink to this definition">¶</a><br><dd><p>Subscribe to a MQTT topic and automatically parse JSON payload.<p>If an invalid JSON payload is received, the callback will not be called.<p><dl class="docutils"><dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">topic</span></code>: The topic. Wildcards are currently not supported.<li><code class="docutils literal notranslate"><span class="pre">callback</span></code>: The callback with a parsed JsonObject that will be called when a message with matching topic is received.<li><code class="docutils literal notranslate"><span class="pre">qos</span></code>: The QoS of this subscription.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent7publishERK11MQTTMessage"><span id="_CPPv2N4mqtt19MQTTClientComponent7publishERK11MQTTMessage"></span><span id="mqtt::MQTTClientComponent::publish__MQTTMessageCR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1ad3999bca2b76f44fb2ae16967c11eb27"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">publish</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal"href="#_CPPv3N4mqtt11MQTTMessageE"title="mqtt::MQTTMessage">MQTTMessage</a> &amp;<em>message</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent7publishERK11MQTTMessage"title="Permalink to this definition">¶</a><br><dd><p>Publish a <a class="reference internal"href="#structmqtt_1_1_m_q_t_t_message"><span class="std std-ref">MQTTMessage</span></a>.<p><dl class="docutils"><dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">message</span></code>: The message.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent7publishERKNSt6stringERKNSt6stringE7uint8_tb"><span id="_CPPv2N4mqtt19MQTTClientComponent7publishERKNSt6stringERKNSt6stringE7uint8_tb"></span><span id="mqtt::MQTTClientComponent::publish__ssCR.ssCR.uint8_t.b"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1aaed32f5b696f9c0f8fe75734b884b3a9"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">publish</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>topic</em>, <em class="property">const</em> std::string &amp;<em>payload</em>, uint8_t <em>qos</em>, bool <em>retain</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent7publishERKNSt6stringERKNSt6stringE7uint8_tb"title="Permalink to this definition">¶</a><br><dd><p>Publish a MQTT message.<p><dl class="docutils"><dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">topic</span></code>: The topic.<li><code class="docutils literal notranslate"><span class="pre">payload</span></code>: The payload.<li><code class="docutils literal notranslate"><span class="pre">retain</span></code>: Whether to retain the message.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent12publish_jsonERKNSt6stringERK12json_build_t7uint8_tb"><span id="_CPPv2N4mqtt19MQTTClientComponent12publish_jsonERKNSt6stringERK12json_build_t7uint8_tb"></span><span id="mqtt::MQTTClientComponent::publish_json__ssCR.json_build_tCR.uint8_t.b"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a96a3ec4d0a1111fb54ccb766c0c22ab2"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">publish_json</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>topic</em>, <em class="property">const</em> <a class="reference internal"href="helpers.html#_CPPv312json_build_t"title="json_build_t">json_build_t</a> &amp;<em>f</em>, uint8_t <em>qos</em>, bool <em>retain</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent12publish_jsonERKNSt6stringERK12json_build_t7uint8_tb"title="Permalink to this definition">¶</a><br><dd><p>Construct and send a JSON MQTT message.<p><dl class="docutils"><dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">topic</span></code>: The topic.<li><code class="docutils literal notranslate"><span class="pre">f</span></code>: The Json Message builder.<li><code class="docutils literal notranslate"><span class="pre">retain</span></code>: Whether to retain the message.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent12is_connectedEv"><span id="_CPPv2N4mqtt19MQTTClientComponent12is_connectedEv"></span><span id="mqtt::MQTTClientComponent::is_connected"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1ab7abb65e43ad3ee3afd9918d24055060"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">is_connected</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent12is_connectedEv"title="Permalink to this definition">¶</a><br><dd><p>Return whether this client is currently connected to the MQTT server.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent23add_on_connect_callbackERRNSt8functionIFvvEEE"><span id="_CPPv2N4mqtt19MQTTClientComponent23add_on_connect_callbackERRNSt8functionIFvvEEE"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1ae48bc1176352240a1ca4270b847c83f3"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">add_on_connect_callback</code><span class="sig-paren">(</span>std::function&lt;void<span class="sig-paren">(</span><span class="sig-paren">)</span>&gt; &amp;&amp;<em>callback</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent23add_on_connect_callbackERRNSt8functionIFvvEEE"title="Permalink to this definition">¶</a><br><dd><p>Add a callback that will be called every time the MQTT client reconnects.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent5setupEv"><span id="_CPPv2N4mqtt19MQTTClientComponent5setupEv"></span><span id="mqtt::MQTTClientComponent::setup"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a460be83b60464ee2597c3d14ee8344f6"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent5setupEv"title="Permalink to this definition">¶</a><br><dd><p>Setup the MQTT client, registering a bunch of callbacks and attempting to connect.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent4loopEv"><span id="_CPPv2N4mqtt19MQTTClientComponent4loopEv"></span><span id="mqtt::MQTTClientComponent::loop"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1acdc51ee76b882404be8961d922835672"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">loop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent4loopEv"title="Permalink to this definition">¶</a><br><dd><p>Reconnect if required.</dl><dl class="function"><dt id="_CPPv3NK4mqtt19MQTTClientComponent18get_setup_priorityEv"><span id="_CPPv2NK4mqtt19MQTTClientComponent18get_setup_priorityEv"></span><span id="mqtt::MQTTClientComponent::get_setup_priorityC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1abd24fd142deecb0e160f93ea131bc6fc"></span>float mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">get_setup_priority</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt19MQTTClientComponent18get_setup_priorityEv"title="Permalink to this definition">¶</a><br><dd><p>MQTT client setup priority.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent10on_messageERKNSt6stringERKNSt6stringE"><span id="_CPPv2N4mqtt19MQTTClientComponent10on_messageERKNSt6stringERKNSt6stringE"></span><span id="mqtt::MQTTClientComponent::on_message__ssCR.ssCR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a8660ddf4af5d381bfe993d0c68294aa8"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">on_message</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>topic</em>, <em class="property">const</em> std::string &amp;<em>payload</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent10on_messageERKNSt6stringERKNSt6stringE"title="Permalink to this definition">¶</a><br><dd></dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent20make_message_triggerERKNSt6stringE7uint8_t"><span id="_CPPv2N4mqtt19MQTTClientComponent20make_message_triggerERKNSt6stringE7uint8_t"></span><span id="mqtt::MQTTClientComponent::make_message_trigger__ssCR.uint8_t"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1ad99c190fd3df3d6a16b2c3303d60b05c"></span>MQTTMessageTrigger *mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">make_message_trigger</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>topic</em>, uint8_t <em>qos</em> = 0<span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent20make_message_triggerERKNSt6stringE7uint8_t"title="Permalink to this definition">¶</a><br><dd></dl><dl class="function"><dt><em class="property">template </em>&lt;<em class="property">typename</em> T&gt;<dt id="_CPPv3N4mqtt19MQTTClientComponent19make_publish_actionEv"><span id="_CPPv2N4mqtt19MQTTClientComponent19make_publish_actionEv"></span><span id="mqtt::MQTTClientComponent::make_publish_action"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a9d254dff4b5397ede734c0a1de05b58c"></span>MQTTPublishAction&lt;T&gt; *mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">make_publish_action</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent19make_publish_actionEv"title="Permalink to this definition">¶</a><br><dd></dl></div><div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Protected Functions<dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent9reconnectEv"><span id="_CPPv2N4mqtt19MQTTClientComponent9reconnectEv"></span><span id="mqtt::MQTTClientComponent::reconnect"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a03aaa364644cfd11a1b598213b7f4072"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">reconnect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent9reconnectEv"title="Permalink to this definition">¶</a><br><dd><p>Reconnect to the MQTT broker if not already connected.</dl><dl class="function"><dt id="_CPPv3N4mqtt19MQTTClientComponent24recalculate_availabilityEv"><span id="_CPPv2N4mqtt19MQTTClientComponent24recalculate_availabilityEv"></span><span id="mqtt::MQTTClientComponent::recalculate_availability"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1ab010768d6643b6c0f8da28c7ee790714"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">recalculate_availability</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent24recalculate_availabilityEv"title="Permalink to this definition">¶</a><br><dd><p>Re-calculate the availability property.</dl></div><div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Protected Attributes<dl class="member"><dt id="_CPPv3N4mqtt19MQTTClientComponent12credentials_E"><span id="_CPPv2N4mqtt19MQTTClientComponent12credentials_E"></span><span id="mqtt::MQTTClientComponent::credentials___MQTTCredentials"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a558b9268debb549e1d8d62abfa1cdb6c"></span><a class="reference internal"href="#_CPPv3N4mqtt15MQTTCredentialsE"title="mqtt::MQTTCredentials">MQTTCredentials</a> mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">credentials_</code><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent12credentials_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt19MQTTClientComponent10last_will_E"><span id="_CPPv2N4mqtt19MQTTClientComponent10last_will_E"></span><span id="mqtt::MQTTClientComponent::last_will___MQTTMessage"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1af3d7aea3f7462425387d8f4e0ac51115"></span><a class="reference internal"href="#_CPPv3N4mqtt11MQTTMessageE"title="mqtt::MQTTMessage">MQTTMessage</a> mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">last_will_</code><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent10last_will_E"title="Permalink to this definition">¶</a><br><dd><p>The last will message.<p>Disabled optional denotes it being default and an empty topic denotes the the feature being disabled.</dl><dl class="member"><dt id="_CPPv3N4mqtt19MQTTClientComponent14birth_message_E"><span id="_CPPv2N4mqtt19MQTTClientComponent14birth_message_E"></span><span id="mqtt::MQTTClientComponent::birth_message___MQTTMessage"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a76a4611e2a807d309a3bc4db7e934141"></span><a class="reference internal"href="#_CPPv3N4mqtt11MQTTMessageE"title="mqtt::MQTTMessage">MQTTMessage</a> mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">birth_message_</code><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent14birth_message_E"title="Permalink to this definition">¶</a><br><dd><p>The birth message (e.g.<p>the message that’s send on an established connection. See last_will_ for what different values denote.</dl><dl class="member"><dt id="_CPPv3N4mqtt19MQTTClientComponent13availability_E"><span id="_CPPv2N4mqtt19MQTTClientComponent13availability_E"></span><span id="mqtt::MQTTClientComponent::availability___Availability"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1ab2816a6236a976abd9d98c369ff6c9ae"></span><a class="reference internal"href="#_CPPv3N4mqtt12AvailabilityE"title="mqtt::Availability">Availability</a> mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">availability_</code> = {}<a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent13availability_E"title="Permalink to this definition">¶</a><br><dd><p>Caches availability.</dl><dl class="member"><dt id="_CPPv3N4mqtt19MQTTClientComponent15discovery_info_E"><span id="_CPPv2N4mqtt19MQTTClientComponent15discovery_info_E"></span><span id="mqtt::MQTTClientComponent::discovery_info___MQTTDiscoveryInfo"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a150d812daff48b34160facc53b5f79a6"></span><a class="reference internal"href="#_CPPv3N4mqtt17MQTTDiscoveryInfoE"title="mqtt::MQTTDiscoveryInfo">MQTTDiscoveryInfo</a> mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">discovery_info_</code> = { .prefix = &quot;homeassistant&quot;, .retain = true }<a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent15discovery_info_E"title="Permalink to this definition">¶</a><br><dd><p>The discovery info options for Home Assistant.<p>Undefined optional means default and empty prefix means disabled.</dl><dl class="member"><dt id="_CPPv3N4mqtt19MQTTClientComponent13topic_prefix_E"><span id="_CPPv2N4mqtt19MQTTClientComponent13topic_prefix_E"></span><span id="mqtt::MQTTClientComponent::topic_prefix___ss"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1aa4dba6cac6775dbe1f6cdfe66542d6c1"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">topic_prefix_</code> = {}<a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent13topic_prefix_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt19MQTTClientComponent12log_message_E"><span id="_CPPv2N4mqtt19MQTTClientComponent12log_message_E"></span><span id="mqtt::MQTTClientComponent::log_message___MQTTMessage"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a156d6a886db2fbdb8e68c6ee96c43ea5"></span><a class="reference internal"href="#_CPPv3N4mqtt11MQTTMessageE"title="mqtt::MQTTMessage">MQTTMessage</a> mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">log_message_</code><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent12log_message_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt19MQTTClientComponent14subscriptions_E"><span id="_CPPv2N4mqtt19MQTTClientComponent14subscriptions_E"></span><span id="mqtt::MQTTClientComponent::subscriptions___std::vector:MQTTSubscription:"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1ada68044c97085265847762448e8e84b3"></span>std::vector&lt;<a class="reference internal"href="#_CPPv3N4mqtt16MQTTSubscriptionE"title="mqtt::MQTTSubscription">MQTTSubscription</a>&gt; mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">subscriptions_</code><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent14subscriptions_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt19MQTTClientComponent12mqtt_client_E"><span id="_CPPv2N4mqtt19MQTTClientComponent12mqtt_client_E"></span><span id="mqtt::MQTTClientComponent::mqtt_client___AsyncMqttClient"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a7abd3b9f6c6d3502db880d78b9d1e1ad"></span>AsyncMqttClient mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">mqtt_client_</code><a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent12mqtt_client_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt19MQTTClientComponent11on_connect_E"><span id="_CPPv2N4mqtt19MQTTClientComponent11on_connect_E"></span><span class="target"id="classmqtt_1_1_m_q_t_t_client_component_1a0fa407c33ca9b3febad05e875bc7c3b9"></span>CallbackManager&lt;void<span class="sig-paren">(</span><span class="sig-paren">)</span>&gt; mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a><code class="descname">on_connect_</code> = {}<a class="headerlink"href="#_CPPv3N4mqtt19MQTTClientComponent11on_connect_E"title="Permalink to this definition">¶</a><br><dd></dl></div></dl><dl class="type"><dt><span class="target"id="mqtt__client__component_8h_1a209f22eeee2811eec7a644ef77f4d571"></span><em class="property">using </em><code class="descname">mqtt::mqtt_callback_t = typedef std::function&lt;void(const std::string &amp;)&gt;</code><dd><p>Callback for MQTT subscriptions.<p>First parameter is the topic, the second one is the payload.</dl><dl class="class"><dt id="_CPPv3N4mqtt11MQTTMessageE"><span id="_CPPv2N4mqtt11MQTTMessageE"></span><span id="mqtt::MQTTMessage"></span><span class="target"id="structmqtt_1_1_m_q_t_t_message"></span><em class="property">struct </em>mqtt<code class="descclassname">::</code><code class="descname">MQTTMessage</code><a class="headerlink"href="#_CPPv3N4mqtt11MQTTMessageE"title="Permalink to this definition">¶</a><br><dd><p>internal struct for MQTT messages.<div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Public Members<dl class="member"><dt id="_CPPv3N4mqtt11MQTTMessage5topicE"><span id="_CPPv2N4mqtt11MQTTMessage5topicE"></span><span id="mqtt::MQTTMessage::topic__ss"></span><span class="target"id="structmqtt_1_1_m_q_t_t_message_1adde5637ec7f008a3092754686369f71e"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt11MQTTMessageE"title="mqtt::MQTTMessage">MQTTMessage</a><code class="descname">topic</code><a class="headerlink"href="#_CPPv3N4mqtt11MQTTMessage5topicE"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt11MQTTMessage7payloadE"><span id="_CPPv2N4mqtt11MQTTMessage7payloadE"></span><span id="mqtt::MQTTMessage::payload__ss"></span><span class="target"id="structmqtt_1_1_m_q_t_t_message_1a51f06bdbae48ba93ec27b9e0f8d9c518"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt11MQTTMessageE"title="mqtt::MQTTMessage">MQTTMessage</a><code class="descname">payload</code><a class="headerlink"href="#_CPPv3N4mqtt11MQTTMessage7payloadE"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt11MQTTMessage3qosE"><span id="_CPPv2N4mqtt11MQTTMessage3qosE"></span><span id="mqtt::MQTTMessage::qos__uint8_t"></span><span class="target"id="structmqtt_1_1_m_q_t_t_message_1aaa9785354e60d266f5a71485af54b566"></span>uint8_t mqtt::<a class="reference internal"href="#_CPPv3N4mqtt11MQTTMessageE"title="mqtt::MQTTMessage">MQTTMessage</a><code class="descname">qos</code><a class="headerlink"href="#_CPPv3N4mqtt11MQTTMessage3qosE"title="Permalink to this definition">¶</a><br><dd><p>QoS. Only for last will testaments.</dl><dl class="member"><dt id="_CPPv3N4mqtt11MQTTMessage6retainE"><span id="_CPPv2N4mqtt11MQTTMessage6retainE"></span><span id="mqtt::MQTTMessage::retain__b"></span><span class="target"id="structmqtt_1_1_m_q_t_t_message_1a345b1b66738dd33ad47252eeba15750f"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt11MQTTMessageE"title="mqtt::MQTTMessage">MQTTMessage</a><code class="descname">retain</code><a class="headerlink"href="#_CPPv3N4mqtt11MQTTMessage6retainE"title="Permalink to this definition">¶</a><br><dd></dl></div></dl><dl class="class"><dt id="_CPPv3N4mqtt16MQTTSubscriptionE"><span id="_CPPv2N4mqtt16MQTTSubscriptionE"></span><span id="mqtt::MQTTSubscription"></span><span class="target"id="structmqtt_1_1_m_q_t_t_subscription"></span><em class="property">struct </em>mqtt<code class="descclassname">::</code><code class="descname">MQTTSubscription</code><a class="headerlink"href="#_CPPv3N4mqtt16MQTTSubscriptionE"title="Permalink to this definition">¶</a><br><dd><p>internal struct for MQTT subscriptions.<div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Public Members<dl class="member"><dt id="_CPPv3N4mqtt16MQTTSubscription5topicE"><span id="_CPPv2N4mqtt16MQTTSubscription5topicE"></span><span id="mqtt::MQTTSubscription::topic__ss"></span><span class="target"id="structmqtt_1_1_m_q_t_t_subscription_1af9ff46d51ba230fb68595395e2c27ee6"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt16MQTTSubscriptionE"title="mqtt::MQTTSubscription">MQTTSubscription</a><code class="descname">topic</code><a class="headerlink"href="#_CPPv3N4mqtt16MQTTSubscription5topicE"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt16MQTTSubscription3qosE"><span id="_CPPv2N4mqtt16MQTTSubscription3qosE"></span><span id="mqtt::MQTTSubscription::qos__uint8_t"></span><span class="target"id="structmqtt_1_1_m_q_t_t_subscription_1a7f361dafbc1362f60ebf0ac160549106"></span>uint8_t mqtt::<a class="reference internal"href="#_CPPv3N4mqtt16MQTTSubscriptionE"title="mqtt::MQTTSubscription">MQTTSubscription</a><code class="descname">qos</code><a class="headerlink"href="#_CPPv3N4mqtt16MQTTSubscription3qosE"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt16MQTTSubscription8callbackE"><span id="_CPPv2N4mqtt16MQTTSubscription8callbackE"></span><span id="mqtt::MQTTSubscription::callback__mqtt_callback_t"></span><span class="target"id="structmqtt_1_1_m_q_t_t_subscription_1acf8b1bb7c0f1d483804611eb3c9d0bdf"></span>mqtt_callback_t mqtt::<a class="reference internal"href="#_CPPv3N4mqtt16MQTTSubscriptionE"title="mqtt::MQTTSubscription">MQTTSubscription</a><code class="descname">callback</code><a class="headerlink"href="#_CPPv3N4mqtt16MQTTSubscription8callbackE"title="Permalink to this definition">¶</a><br><dd></dl></div></dl><dl class="class"><dt id="_CPPv3N4mqtt15MQTTCredentialsE"><span id="_CPPv2N4mqtt15MQTTCredentialsE"></span><span id="mqtt::MQTTCredentials"></span><span class="target"id="structmqtt_1_1_m_q_t_t_credentials"></span><em class="property">struct </em>mqtt<code class="descclassname">::</code><code class="descname">MQTTCredentials</code><a class="headerlink"href="#_CPPv3N4mqtt15MQTTCredentialsE"title="Permalink to this definition">¶</a><br><dd><p>internal struct for MQTT credentials.<div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Public Members<dl class="member"><dt id="_CPPv3N4mqtt15MQTTCredentials7addressE"><span id="_CPPv2N4mqtt15MQTTCredentials7addressE"></span><span id="mqtt::MQTTCredentials::address__ss"></span><span class="target"id="structmqtt_1_1_m_q_t_t_credentials_1ab353cb9f76211ab29146bfebcc24ebf3"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt15MQTTCredentialsE"title="mqtt::MQTTCredentials">MQTTCredentials</a><code class="descname">address</code><a class="headerlink"href="#_CPPv3N4mqtt15MQTTCredentials7addressE"title="Permalink to this definition">¶</a><br><dd><p>The address of the server without port number.</dl><dl class="member"><dt id="_CPPv3N4mqtt15MQTTCredentials4portE"><span id="_CPPv2N4mqtt15MQTTCredentials4portE"></span><span id="mqtt::MQTTCredentials::port__uint16_t"></span><span class="target"id="structmqtt_1_1_m_q_t_t_credentials_1a29e8a4fcfbe773df25994d80a3626009"></span>uint16_t mqtt::<a class="reference internal"href="#_CPPv3N4mqtt15MQTTCredentialsE"title="mqtt::MQTTCredentials">MQTTCredentials</a><code class="descname">port</code><a class="headerlink"href="#_CPPv3N4mqtt15MQTTCredentials4portE"title="Permalink to this definition">¶</a><br><dd><p>The port number of the server.</dl><dl class="member"><dt id="_CPPv3N4mqtt15MQTTCredentials8usernameE"><span id="_CPPv2N4mqtt15MQTTCredentials8usernameE"></span><span id="mqtt::MQTTCredentials::username__ss"></span><span class="target"id="structmqtt_1_1_m_q_t_t_credentials_1a4fc22d4d45f4c301a793930cf53935d1"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt15MQTTCredentialsE"title="mqtt::MQTTCredentials">MQTTCredentials</a><code class="descname">username</code><a class="headerlink"href="#_CPPv3N4mqtt15MQTTCredentials8usernameE"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt15MQTTCredentials8passwordE"><span id="_CPPv2N4mqtt15MQTTCredentials8passwordE"></span><span id="mqtt::MQTTCredentials::password__ss"></span><span class="target"id="structmqtt_1_1_m_q_t_t_credentials_1adfd147097861a188f6c1310612d9249c"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt15MQTTCredentialsE"title="mqtt::MQTTCredentials">MQTTCredentials</a><code class="descname">password</code><a class="headerlink"href="#_CPPv3N4mqtt15MQTTCredentials8passwordE"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt15MQTTCredentials9client_idE"><span id="_CPPv2N4mqtt15MQTTCredentials9client_idE"></span><span id="mqtt::MQTTCredentials::client_id__ss"></span><span class="target"id="structmqtt_1_1_m_q_t_t_credentials_1ad4e02559b2f722fadad99a78ae2821b0"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt15MQTTCredentialsE"title="mqtt::MQTTCredentials">MQTTCredentials</a><code class="descname">client_id</code><a class="headerlink"href="#_CPPv3N4mqtt15MQTTCredentials9client_idE"title="Permalink to this definition">¶</a><br><dd><p>The client ID. Will automatically be truncated to 23 characters.</dl></div></dl><dl class="class"><dt id="_CPPv3N4mqtt12AvailabilityE"><span id="_CPPv2N4mqtt12AvailabilityE"></span><span id="mqtt::Availability"></span><span class="target"id="structmqtt_1_1_availability"></span><em class="property">struct </em>mqtt<code class="descclassname">::</code><code class="descname">Availability</code><a class="headerlink"href="#_CPPv3N4mqtt12AvailabilityE"title="Permalink to this definition">¶</a><br><dd><p>Simple data struct for Home Assistant component availability.<div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Public Members<dl class="member"><dt id="_CPPv3N4mqtt12Availability5topicE"><span id="_CPPv2N4mqtt12Availability5topicE"></span><span id="mqtt::Availability::topic__ss"></span><span class="target"id="structmqtt_1_1_availability_1adde39a59ac0430a119d0aa77277676b7"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt12AvailabilityE"title="mqtt::Availability">Availability</a><code class="descname">topic</code><a class="headerlink"href="#_CPPv3N4mqtt12Availability5topicE"title="Permalink to this definition">¶</a><br><dd><p>Empty means disabled.</dl><dl class="member"><dt id="_CPPv3N4mqtt12Availability17payload_availableE"><span id="_CPPv2N4mqtt12Availability17payload_availableE"></span><span id="mqtt::Availability::payload_available__ss"></span><span class="target"id="structmqtt_1_1_availability_1a3f23351fff31f2d6cdd2931c2086d94c"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt12AvailabilityE"title="mqtt::Availability">Availability</a><code class="descname">payload_available</code><a class="headerlink"href="#_CPPv3N4mqtt12Availability17payload_availableE"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt12Availability21payload_not_availableE"><span id="_CPPv2N4mqtt12Availability21payload_not_availableE"></span><span id="mqtt::Availability::payload_not_available__ss"></span><span class="target"id="structmqtt_1_1_availability_1afc59f141d2cfb801063a30aabe62f872"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt12AvailabilityE"title="mqtt::Availability">Availability</a><code class="descname">payload_not_available</code><a class="headerlink"href="#_CPPv3N4mqtt12Availability21payload_not_availableE"title="Permalink to this definition">¶</a><br><dd></dl></div></dl><dl class="class"><dt id="_CPPv3N4mqtt17MQTTDiscoveryInfoE"><span id="_CPPv2N4mqtt17MQTTDiscoveryInfoE"></span><span id="mqtt::MQTTDiscoveryInfo"></span><span class="target"id="structmqtt_1_1_m_q_t_t_discovery_info"></span><em class="property">struct </em>mqtt<code class="descclassname">::</code><code class="descname">MQTTDiscoveryInfo</code><a class="headerlink"href="#_CPPv3N4mqtt17MQTTDiscoveryInfoE"title="Permalink to this definition">¶</a><br><dd><p>Internal struct for MQTT Home Assistant discovery.<p>See <a class="reference external"href="https://home-assistant.io/docs/mqtt/discovery/">MQTT Discovery</a>.<div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Public Members<dl class="member"><dt id="_CPPv3N4mqtt17MQTTDiscoveryInfo6prefixE"><span id="_CPPv2N4mqtt17MQTTDiscoveryInfo6prefixE"></span><span id="mqtt::MQTTDiscoveryInfo::prefix__ss"></span><span class="target"id="structmqtt_1_1_m_q_t_t_discovery_info_1a2b661677ad7719d77f5dc72715c95a3d"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt17MQTTDiscoveryInfoE"title="mqtt::MQTTDiscoveryInfo">MQTTDiscoveryInfo</a><code class="descname">prefix</code><a class="headerlink"href="#_CPPv3N4mqtt17MQTTDiscoveryInfo6prefixE"title="Permalink to this definition">¶</a><br><dd><p>The Home Assistant discovery prefix. Empty means disabled.</dl><dl class="member"><dt id="_CPPv3N4mqtt17MQTTDiscoveryInfo6retainE"><span id="_CPPv2N4mqtt17MQTTDiscoveryInfo6retainE"></span><span id="mqtt::MQTTDiscoveryInfo::retain__b"></span><span class="target"id="structmqtt_1_1_m_q_t_t_discovery_info_1a8cb173534707d678b1da0a0b516b1824"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt17MQTTDiscoveryInfoE"title="mqtt::MQTTDiscoveryInfo">MQTTDiscoveryInfo</a><code class="descname">retain</code><a class="headerlink"href="#_CPPv3N4mqtt17MQTTDiscoveryInfo6retainE"title="Permalink to this definition">¶</a><br><dd><p>Whether to retain discovery messages.</dl></div></dl><dl class="member"><dt id="_CPPv3N4mqtt18global_mqtt_clientE"><span id="_CPPv2N4mqtt18global_mqtt_clientE"></span><span id="mqtt::global_mqtt_client__MQTTClientComponentP"></span><span class="target"id="mqtt__client__component_8cpp_1a183237dad9d963073559fc91fda61441"></span><a class="reference internal"href="#_CPPv3N4mqtt19MQTTClientComponentE"title="mqtt::MQTTClientComponent">MQTTClientComponent</a> *mqtt<code class="descclassname">::</code><code class="descname">global_mqtt_client</code> = nullptr<a class="headerlink"href="#_CPPv3N4mqtt18global_mqtt_clientE"title="Permalink to this definition">¶</a><br><dd></dl></div><div class="section"id="mqttcomponent"><h3>MQTTComponent<a class="headerlink"href="#mqttcomponent"title="Permalink to this headline">¶</a></h3><dl class="class"><dt id="_CPPv3N4mqtt13MQTTComponentE"><span id="_CPPv2N4mqtt13MQTTComponentE"></span><span id="mqtt::MQTTComponent"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component"></span><em class="property">class </em>mqtt<code class="descclassname">::</code><code class="descname">MQTTComponent</code><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponentE"title="Permalink to this definition">¶</a><br><dd><p><a class="reference internal"href="#classmqtt_1_1_m_q_t_t_component"><span class="std std-ref">MQTTComponent</span></a> is the base class for all components that interact with MQTT to expose certain functionality or data from actuators or sensors to clients.<p>Although this class should work with all MQTT solutions, it has been specifically designed for use with Home Assistant. For example, this class supports Home Assistant MQTT discovery out of the box.<p>In order to implement automatic Home Assistant discovery, all sub-classes should:<p><ol class="arabic simple"><li>Implement send_discovery that creates a Home Assistant discovery payload.<li>Override <a class="reference internal"href="#classmqtt_1_1_m_q_t_t_component_1aa7531fc685601d89f7c0dd8b68625fc3"><span class="std std-ref">component_type()</span></a> to return the appropriate component type such as “light” or “sensor”.<li>Subscribe to command topics using <a class="reference internal"href="#classmqtt_1_1_m_q_t_t_component_1af5d2bf20c72f150ff7b45684c6e3986f"><span class="std std-ref">subscribe()</span></a> or <a class="reference internal"href="#classmqtt_1_1_m_q_t_t_component_1ae352d2aa6507cd970eef989c025cd957"><span class="std std-ref">subscribe_json()</span></a> during <a class="reference internal"href="component.html#class_component_1a9cc04b36ceb2cf5bb0abe5672b096c64"><span class="std std-ref">setup()</span></a>.</ol><p><p>In order to best separate the front- and back-end of esphomelib, all sub-classes should only parse/send MQTT messages and interact with back-end components via callbacks to ensure a clean separation.<p>Inherits from <a class="reference internal"href="component.html#class_component"><span class="std std-ref">Component</span></a><p>Subclassed by <a class="reference internal"href="../binary_sensor/index.html#classbinary__sensor_1_1_m_q_t_t_binary_sensor_component"><span class="std std-ref">binary_sensor::MQTTBinarySensorComponent</span></a>, <a class="reference internal"href="../cover/index.html#classcover_1_1_m_q_t_t_cover_component"><span class="std std-ref">cover::MQTTCoverComponent</span></a>, <a class="reference internal"href="../fan/index.html#classfan_1_1_m_q_t_t_fan_component"><span class="std std-ref">fan::MQTTFanComponent</span></a>, <a class="reference internal"href="../light/index.html#classlight_1_1_m_q_t_t_j_s_o_n_light_component"><span class="std std-ref">light::MQTTJSONLightComponent</span></a>, <a class="reference internal"href="../sensor/index.html#classsensor_1_1_m_q_t_t_sensor_component"><span class="std std-ref">sensor::MQTTSensorComponent</span></a><div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Public Functions<dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent13MQTTComponentEv"><span id="_CPPv2N4mqtt13MQTTComponent13MQTTComponentEv"></span><span id="mqtt::MQTTComponent::MQTTComponent"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1ac193cd15b49edb97149aaada09e2a348"></span>mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">MQTTComponent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent13MQTTComponentEv"title="Permalink to this definition">¶</a><br><dd><p>Constructs a <a class="reference internal"href="#classmqtt_1_1_m_q_t_t_component"><span class="std std-ref">MQTTComponent</span></a>.</dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent6setup_Ev"><span id="_CPPv2N4mqtt13MQTTComponent6setup_Ev"></span><span id="mqtt::MQTTComponent::setup_"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1aa44d0181955e1229519b641e55a7f560"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">setup_</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent6setup_Ev"title="Permalink to this definition">¶</a><br><dd><p>Override setup_ so that we can call <a class="reference internal"href="#classmqtt_1_1_m_q_t_t_component_1aa4de476e2183443d37da3e4c6137a980"><span class="std std-ref">send_discovery()</span></a> when needed.</dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent5loop_Ev"><span id="_CPPv2N4mqtt13MQTTComponent5loop_Ev"></span><span id="mqtt::MQTTComponent::loop_"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1adc53bd20982915f86f1936b488a3fa2b"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">loop_</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent5loop_Ev"title="Permalink to this definition">¶</a><br><dd><p>Public <a class="reference internal"href="component.html#class_component_1a6e7ddc3311aafcf6900ef61a10dfa4e5"><span class="std std-ref">loop()</span></a> functions.<p>These will be called by the <a class="reference internal"href="application.html#class_application"><span class="std std-ref">Application</span></a> instance.<p>Note: This should normally not be overriden, unless you know what you’re doing. They’re basically to make creating custom components easier. For example the SensorComponent can override these methods to not have the user call some super methods within their custom sensors. These methods should ALWAYS call the loop_internal() and setup_internal() methods.<p>Basically, it handles stuff like interval/timeout functions and eventually calls <a class="reference internal"href="component.html#class_component_1a6e7ddc3311aafcf6900ef61a10dfa4e5"><span class="std std-ref">loop()</span></a>.</dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent14send_discoveryER10JsonBufferR10JsonObjectR19SendDiscoveryConfig"><span id="_CPPv2N4mqtt13MQTTComponent14send_discoveryER10JsonBufferR10JsonObjectR19SendDiscoveryConfig"></span><span id="mqtt::MQTTComponent::send_discovery__JsonBufferR.JsonObjectR.SendDiscoveryConfigR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1aa4de476e2183443d37da3e4c6137a980"></span><em class="property">virtual</em> void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">send_discovery</code><span class="sig-paren">(</span>JsonBuffer &amp;<em>buffer</em>, JsonObject &amp;<em>root</em>, <a class="reference internal"href="#_CPPv3N4mqtt19SendDiscoveryConfigE"title="mqtt::SendDiscoveryConfig">SendDiscoveryConfig</a> &amp;<em>config</em><span class="sig-paren">)</span> = 0<a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent14send_discoveryER10JsonBufferR10JsonObjectR19SendDiscoveryConfig"title="Permalink to this definition">¶</a><br><dd><p>Send discovery info the Home Assistant, override this.</dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent10set_retainEb"><span id="_CPPv2N4mqtt13MQTTComponent10set_retainEb"></span><span id="mqtt::MQTTComponent::set_retain__b"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1acd637d0a124ef6bec8596f897ec7af2b"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">set_retain</code><span class="sig-paren">(</span>bool <em>retain</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent10set_retainEb"title="Permalink to this definition">¶</a><br><dd><p>Set whether state message should be retained.</dl><dl class="function"><dt id="_CPPv3NK4mqtt13MQTTComponent10get_retainEv"><span id="_CPPv2NK4mqtt13MQTTComponent10get_retainEv"></span><span id="mqtt::MQTTComponent::get_retainC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1adcf6a65de7d5e79c492f73a25650bde8"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">get_retain</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt13MQTTComponent10get_retainEv"title="Permalink to this definition">¶</a><br><dd></dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent17disable_discoveryEv"><span id="_CPPv2N4mqtt13MQTTComponent17disable_discoveryEv"></span><span id="mqtt::MQTTComponent::disable_discovery"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a7996134f103b5a36810df7512cfab6db"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">disable_discovery</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent17disable_discoveryEv"title="Permalink to this definition">¶</a><br><dd><p>Disable discovery. Sets friendly name to “”.</dl><dl class="function"><dt id="_CPPv3NK4mqtt13MQTTComponent20is_discovery_enabledEv"><span id="_CPPv2NK4mqtt13MQTTComponent20is_discovery_enabledEv"></span><span id="mqtt::MQTTComponent::is_discovery_enabledC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1ae1fa70eaf27c2b5e5ddb57f7c121ed9e"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">is_discovery_enabled</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt13MQTTComponent20is_discovery_enabledEv"title="Permalink to this definition">¶</a><br><dd></dl><dl class="function"><dt id="_CPPv3NK4mqtt13MQTTComponent14component_typeEv"><span id="_CPPv2NK4mqtt13MQTTComponent14component_typeEv"></span><span id="mqtt::MQTTComponent::component_typeC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1aa7531fc685601d89f7c0dd8b68625fc3"></span><em class="property">virtual</em> std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">component_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink"href="#_CPPv3NK4mqtt13MQTTComponent14component_typeEv"title="Permalink to this definition">¶</a><br><dd><p>Override this method to return the component type (e.g. “light”, “sensor”, …)</dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent22set_custom_state_topicERKNSt6stringE"><span id="_CPPv2N4mqtt13MQTTComponent22set_custom_state_topicERKNSt6stringE"></span><span id="mqtt::MQTTComponent::set_custom_state_topic__ssCR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a2103e7b16fcbc701f1af1dd70274d545"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">set_custom_state_topic</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>custom_state_topic</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent22set_custom_state_topicERKNSt6stringE"title="Permalink to this definition">¶</a><br><dd><p>Set a custom state topic. Set to “” for default behavior.</dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent24set_custom_command_topicERKNSt6stringE"><span id="_CPPv2N4mqtt13MQTTComponent24set_custom_command_topicERKNSt6stringE"></span><span id="mqtt::MQTTComponent::set_custom_command_topic__ssCR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1ad303bc02a4df90ec25fbeb438d303b7c"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">set_custom_command_topic</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>custom_command_topic</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent24set_custom_command_topicERKNSt6stringE"title="Permalink to this definition">¶</a><br><dd><p>Set a custom command topic. Set to “” for default behavior.</dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent16set_custom_topicERKNSt6stringERKNSt6stringE"><span id="_CPPv2N4mqtt13MQTTComponent16set_custom_topicERKNSt6stringERKNSt6stringE"></span><span id="mqtt::MQTTComponent::set_custom_topic__ssCR.ssCR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a37245bbb2b759f4b96cab6f53516502c"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">set_custom_topic</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>key</em>, <em class="property">const</em> std::string &amp;<em>custom_topic</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent16set_custom_topicERKNSt6stringERKNSt6stringE"title="Permalink to this definition">¶</a><br><dd></dl><dl class="function"><dt id="_CPPv3NK4mqtt13MQTTComponent18get_setup_priorityEv"><span id="_CPPv2NK4mqtt13MQTTComponent18get_setup_priorityEv"></span><span id="mqtt::MQTTComponent::get_setup_priorityC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a91f8c6741712f194d59faf98dc5763fa"></span>float mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">get_setup_priority</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt13MQTTComponent18get_setup_priorityEv"title="Permalink to this definition">¶</a><br><dd><p>MQTT_COMPONENT setup priority.</dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent16set_availabilityENSt6stringENSt6stringENSt6stringE"><span id="_CPPv2N4mqtt13MQTTComponent16set_availabilityENSt6stringENSt6stringENSt6stringE"></span><span id="mqtt::MQTTComponent::set_availability__ss.ss.ss"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a6d9bdc0d97d4136cc6d5b6f4bbb25435"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">set_availability</code><span class="sig-paren">(</span>std::string <em>topic</em>, std::string <em>payload_available</em>, std::string <em>payload_not_available</em><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent16set_availabilityENSt6stringENSt6stringENSt6stringE"title="Permalink to this definition">¶</a><br><dd><p>Set the Home Assistant availability data.<p>See See <a class="reference external"href="https://home-assistant.io/components/binary_sensor.mqtt/">Home Assistant</a> for more info.</dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent20disable_availabilityEv"><span id="_CPPv2N4mqtt13MQTTComponent20disable_availabilityEv"></span><span id="mqtt::MQTTComponent::disable_availability"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a6ca84b30196866a64b3c6fbbd0d0331c"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">disable_availability</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent20disable_availabilityEv"title="Permalink to this definition">¶</a><br><dd></dl></div><div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Protected Functions<dl class="function"><dt id="_CPPv3NK4mqtt13MQTTComponent19get_discovery_topicERK17MQTTDiscoveryInfo"><span id="_CPPv2NK4mqtt13MQTTComponent19get_discovery_topicERK17MQTTDiscoveryInfo"></span><span id="mqtt::MQTTComponent::get_discovery_topic__MQTTDiscoveryInfoCRC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a22c2a4dfe4f545f2d12eb822fd64831e"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">get_discovery_topic</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal"href="#_CPPv3N4mqtt17MQTTDiscoveryInfoE"title="mqtt::MQTTDiscoveryInfo">MQTTDiscoveryInfo</a> &amp;<em>discovery_info</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt13MQTTComponent19get_discovery_topicERK17MQTTDiscoveryInfo"title="Permalink to this definition">¶</a><br><dd><p>Helper method to get the discovery topic for this component.</dl><dl class="function"><dt id="_CPPv3NK4mqtt13MQTTComponent21get_default_topic_forERKNSt6stringE"><span id="_CPPv2NK4mqtt13MQTTComponent21get_default_topic_forERKNSt6stringE"></span><span id="mqtt::MQTTComponent::get_default_topic_for__ssCRC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a6071b8be61999135e0a22e680e2bb8ea"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">get_default_topic_for</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>suffix</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt13MQTTComponent21get_default_topic_forERKNSt6stringE"title="Permalink to this definition">¶</a><br><dd><p>Get this components state/command/…<p>topic.<p><dl class="docutils"><dt><strong>Return</strong><dd>The full topic.<dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">suffix</span></code>: The suffix/key such as “state” or “command”.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3NK4mqtt13MQTTComponent13friendly_nameEv"><span id="_CPPv2NK4mqtt13MQTTComponent13friendly_nameEv"></span><span id="mqtt::MQTTComponent::friendly_nameC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a083a609dee55b13542f4ba64978b7776"></span><em class="property">virtual</em> std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">friendly_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em> = 0<a class="headerlink"href="#_CPPv3NK4mqtt13MQTTComponent13friendly_nameEv"title="Permalink to this definition">¶</a><br><dd><p>Get the friendly name of this MQTT component.</dl><dl class="function"><dt id="_CPPv3NK4mqtt13MQTTComponent15get_state_topicEv"><span id="_CPPv2NK4mqtt13MQTTComponent15get_state_topicEv"></span><span id="mqtt::MQTTComponent::get_state_topicC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1afef0b3b516a2b964cacaa1f462cd988c"></span><em class="property">const</em> std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">get_state_topic</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt13MQTTComponent15get_state_topicEv"title="Permalink to this definition">¶</a><br><dd><p>Get the MQTT topic that new states will be shared to.</dl><dl class="function"><dt id="_CPPv3NK4mqtt13MQTTComponent17get_command_topicEv"><span id="_CPPv2NK4mqtt13MQTTComponent17get_command_topicEv"></span><span id="mqtt::MQTTComponent::get_command_topicC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a1dd188a4241821b97435d09d287b4c89"></span><em class="property">const</em> std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">get_command_topic</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt13MQTTComponent17get_command_topicEv"title="Permalink to this definition">¶</a><br><dd><p>Get the MQTT topic for listening to commands.</dl><dl class="function"><dt id="_CPPv3NK4mqtt13MQTTComponent13get_topic_forERKNSt6stringE"><span id="_CPPv2NK4mqtt13MQTTComponent13get_topic_forERKNSt6stringE"></span><span id="mqtt::MQTTComponent::get_topic_for__ssCRC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1aaae530285cb5e7031a8ba05b6b084128"></span><em class="property">const</em> std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">get_topic_for</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>key</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt13MQTTComponent13get_topic_forERKNSt6stringE"title="Permalink to this definition">¶</a><br><dd><p>Get the MQTT topic for a specific suffix/key, if a custom topic has been defined, that one will be used.<p>Otherwise, one will be generated with <a class="reference internal"href="#classmqtt_1_1_m_q_t_t_component_1a6071b8be61999135e0a22e680e2bb8ea"><span class="std std-ref">get_default_topic_for()</span></a>.</dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent15send_discovery_Ev"><span id="_CPPv2N4mqtt13MQTTComponent15send_discovery_Ev"></span><span id="mqtt::MQTTComponent::send_discovery_"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a6f1b54b7acb5771a3fdd91fa159613ef"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">send_discovery_</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent15send_discovery_Ev"title="Permalink to this definition">¶</a><br><dd><p>Internal method to start sending discovery info, this will call <a class="reference internal"href="#classmqtt_1_1_m_q_t_t_component_1aa4de476e2183443d37da3e4c6137a980"><span class="std std-ref">send_discovery()</span></a>.</dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent12send_messageERKNSt6stringERKNSt6stringERK8optionalI7uint8_tERK8optionalIbE"><span id="_CPPv2N4mqtt13MQTTComponent12send_messageERKNSt6stringERKNSt6stringERK8optionalI7uint8_tERK8optionalIbE"></span><span id="mqtt::MQTTComponent::send_message__ssCR.ssCR.optional:uint8_t:CR.optional:b:CR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1aba84d2b783bda5c9338fe06510867dae"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">send_message</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>topic</em>, <em class="property">const</em> std::string &amp;<em>payload</em>, <em class="property">const</em> <a class="reference internal"href="helpers.html#_CPPv38optional"title="optional">optional</a>&lt;uint8_t&gt; &amp;<em>qos</em> = {}, <em class="property">const</em> <a class="reference internal"href="helpers.html#_CPPv38optional"title="optional">optional</a>&lt;bool&gt; &amp;<em>retain</em> = {}<span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent12send_messageERKNSt6stringERKNSt6stringERK8optionalI7uint8_tERK8optionalIbE"title="Permalink to this definition">¶</a><br><dd><p>Send a MQTT message.<p><dl class="docutils"><dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">topic</span></code>: The topic.<li><code class="docutils literal notranslate"><span class="pre">payload</span></code>: The payload.<li><code class="docutils literal notranslate"><span class="pre">retain</span></code>: Whether to retain the message. If not set, defaults to get_retain.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent17send_json_messageERKNSt6stringERK12json_build_tRK8optionalI7uint8_tERK8optionalIbE"><span id="_CPPv2N4mqtt13MQTTComponent17send_json_messageERKNSt6stringERK12json_build_tRK8optionalI7uint8_tERK8optionalIbE"></span><span id="mqtt::MQTTComponent::send_json_message__ssCR.json_build_tCR.optional:uint8_t:CR.optional:b:CR"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1acba5e093a485ecb28ba2b2a579f77c82"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">send_json_message</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>topic</em>, <em class="property">const</em> <a class="reference internal"href="helpers.html#_CPPv312json_build_t"title="json_build_t">json_build_t</a> &amp;<em>f</em>, <em class="property">const</em> <a class="reference internal"href="helpers.html#_CPPv38optional"title="optional">optional</a>&lt;uint8_t&gt; &amp;<em>qos</em> = {}, <em class="property">const</em> <a class="reference internal"href="helpers.html#_CPPv38optional"title="optional">optional</a>&lt;bool&gt; &amp;<em>retain</em> = {}<span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent17send_json_messageERKNSt6stringERK12json_build_tRK8optionalI7uint8_tERK8optionalIbE"title="Permalink to this definition">¶</a><br><dd><p>Construct and send a JSON MQTT message.<p><dl class="docutils"><dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">topic</span></code>: The topic.<li><code class="docutils literal notranslate"><span class="pre">f</span></code>: The Json Message builder.<li><code class="docutils literal notranslate"><span class="pre">retain</span></code>: Whether to retain the message. If not set, defaults to get_retain.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent9subscribeERKNSt6stringE15mqtt_callback_t7uint8_t"><span id="_CPPv2N4mqtt13MQTTComponent9subscribeERKNSt6stringE15mqtt_callback_t7uint8_t"></span><span id="mqtt::MQTTComponent::subscribe__ssCR.mqtt_callback_t.uint8_t"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1af5d2bf20c72f150ff7b45684c6e3986f"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">subscribe</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>topic</em>, mqtt_callback_t <em>callback</em>, uint8_t <em>qos</em> = 0<span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent9subscribeERKNSt6stringE15mqtt_callback_t7uint8_t"title="Permalink to this definition">¶</a><br><dd><p>Subscribe to a MQTT topic.<p><dl class="docutils"><dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">topic</span></code>: The topic. Wildcards are currently not supported.<li><code class="docutils literal notranslate"><span class="pre">callback</span></code>: The callback that will be called when a message with matching topic is received.<li><code class="docutils literal notranslate"><span class="pre">qos</span></code>: The MQTT quality of service. Defaults to 0.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3N4mqtt13MQTTComponent14subscribe_jsonERKNSt6stringE12json_parse_t7uint8_t"><span id="_CPPv2N4mqtt13MQTTComponent14subscribe_jsonERKNSt6stringE12json_parse_t7uint8_t"></span><span id="mqtt::MQTTComponent::subscribe_json__ssCR.json_parse_t.uint8_t"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1ae352d2aa6507cd970eef989c025cd957"></span>void mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">subscribe_json</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>topic</em>, <a class="reference internal"href="helpers.html#_CPPv312json_parse_t"title="json_parse_t">json_parse_t</a> <em>callback</em>, uint8_t <em>qos</em> = 0<span class="sig-paren">)</span><a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent14subscribe_jsonERKNSt6stringE12json_parse_t7uint8_t"title="Permalink to this definition">¶</a><br><dd><p>Subscribe to a MQTT topic and automatically parse JSON payload.<p>If an invalid JSON payload is received, the callback will not be called.<p><dl class="docutils"><dt><strong>Parameters</strong><dd><ul class="breatheparameterlist first last simple"><li><code class="docutils literal notranslate"><span class="pre">topic</span></code>: The topic. Wildcards are currently not supported.<li><code class="docutils literal notranslate"><span class="pre">callback</span></code>: The callback with a parsed JsonObject that will be called when a message with matching topic is received.<li><code class="docutils literal notranslate"><span class="pre">qos</span></code>: The MQTT quality of service. Defaults to 0.</ul></dl><p></dl><dl class="function"><dt id="_CPPv3NK4mqtt13MQTTComponent21get_default_object_idEv"><span id="_CPPv2NK4mqtt13MQTTComponent21get_default_object_idEv"></span><span id="mqtt::MQTTComponent::get_default_object_idC"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a5f059b6d85913a69cf15f995306ef035"></span>std::string mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">get_default_object_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink"href="#_CPPv3NK4mqtt13MQTTComponent21get_default_object_idEv"title="Permalink to this definition">¶</a><br><dd><p>Generate the Home Assistant MQTT discovery object id by automatically transforming the friendly name.</dl></div><div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Protected Attributes<dl class="member"><dt id="_CPPv3N4mqtt13MQTTComponent14custom_topics_E"><span id="_CPPv2N4mqtt13MQTTComponent14custom_topics_E"></span><span id="mqtt::MQTTComponent::custom_topics___std::map:ss.ss:"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a23781744029454de9d2eaa944702fff5"></span>std::map&lt;std::string, std::string&gt; mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">custom_topics_</code> = {}<a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent14custom_topics_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt13MQTTComponent7retain_E"><span id="_CPPv2N4mqtt13MQTTComponent7retain_E"></span><span id="mqtt::MQTTComponent::retain___b"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a0da8e96b1e76f438ff14a946c40c182e"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">retain_</code> = {true}<a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent7retain_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt13MQTTComponent18discovery_enabled_E"><span id="_CPPv2N4mqtt13MQTTComponent18discovery_enabled_E"></span><span id="mqtt::MQTTComponent::discovery_enabled___b"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1a45acec3519bb562010bcc8c72053ecc3"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">discovery_enabled_</code> = {true}<a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent18discovery_enabled_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt13MQTTComponent13availability_E"><span id="_CPPv2N4mqtt13MQTTComponent13availability_E"></span><span id="mqtt::MQTTComponent::availability___AvailabilityP"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1abdf647e145d39e1bd800509d73e97df6"></span><a class="reference internal"href="#_CPPv3N4mqtt12AvailabilityE"title="mqtt::Availability">Availability</a> *mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">availability_</code> = {nullptr}<a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent13availability_E"title="Permalink to this definition">¶</a><br><dd></dl><dl class="member"><dt id="_CPPv3N4mqtt13MQTTComponent20next_send_discovery_E"><span id="_CPPv2N4mqtt13MQTTComponent20next_send_discovery_E"></span><span id="mqtt::MQTTComponent::next_send_discovery___b"></span><span class="target"id="classmqtt_1_1_m_q_t_t_component_1aa34c3f14c4c6925c1023adc5872cbb91"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt13MQTTComponentE"title="mqtt::MQTTComponent">MQTTComponent</a><code class="descname">next_send_discovery_</code> = {true}<a class="headerlink"href="#_CPPv3N4mqtt13MQTTComponent20next_send_discovery_E"title="Permalink to this definition">¶</a><br><dd></dl></div></dl><dl class="class"><dt id="_CPPv3N4mqtt19SendDiscoveryConfigE"><span id="_CPPv2N4mqtt19SendDiscoveryConfigE"></span><span id="mqtt::SendDiscoveryConfig"></span><span class="target"id="structmqtt_1_1_send_discovery_config"></span><em class="property">struct </em>mqtt<code class="descclassname">::</code><code class="descname">SendDiscoveryConfig</code><a class="headerlink"href="#_CPPv3N4mqtt19SendDiscoveryConfigE"title="Permalink to this definition">¶</a><br><dd><p>Simple Helper struct used for Home Assistant MQTT send_discovery().<div class="breathe-sectiondef docutils container"><p class="breathe-sectiondef-title rubric">Public Members<dl class="member"><dt id="_CPPv3N4mqtt19SendDiscoveryConfig11state_topicE"><span id="_CPPv2N4mqtt19SendDiscoveryConfig11state_topicE"></span><span id="mqtt::SendDiscoveryConfig::state_topic__b"></span><span class="target"id="structmqtt_1_1_send_discovery_config_1a8b5c32636a10c04862508854917521e1"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19SendDiscoveryConfigE"title="mqtt::SendDiscoveryConfig">SendDiscoveryConfig</a><code class="descname">state_topic</code> = {true}<a class="headerlink"href="#_CPPv3N4mqtt19SendDiscoveryConfig11state_topicE"title="Permalink to this definition">¶</a><br><dd><p>If the state topic should be included. Defaults to true.</dl><dl class="member"><dt id="_CPPv3N4mqtt19SendDiscoveryConfig13command_topicE"><span id="_CPPv2N4mqtt19SendDiscoveryConfig13command_topicE"></span><span id="mqtt::SendDiscoveryConfig::command_topic__b"></span><span class="target"id="structmqtt_1_1_send_discovery_config_1a90603c2f95ae6057b9e56c070bee47e0"></span>bool mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19SendDiscoveryConfigE"title="mqtt::SendDiscoveryConfig">SendDiscoveryConfig</a><code class="descname">command_topic</code> = {true}<a class="headerlink"href="#_CPPv3N4mqtt19SendDiscoveryConfig13command_topicE"title="Permalink to this definition">¶</a><br><dd><p>If the command topic should be included. Default to true.</dl><dl class="member"><dt id="_CPPv3N4mqtt19SendDiscoveryConfig8platformE"><span id="_CPPv2N4mqtt19SendDiscoveryConfig8platformE"></span><span id="mqtt::SendDiscoveryConfig::platform__cCP"></span><span class="target"id="structmqtt_1_1_send_discovery_config_1a9837a76250852f15c0f4cc3957604fc3"></span><em class="property">const</em> char *mqtt::<a class="reference internal"href="#_CPPv3N4mqtt19SendDiscoveryConfigE"title="mqtt::SendDiscoveryConfig">SendDiscoveryConfig</a><code class="descname">platform</code> = {&quot;mqtt&quot;}<a class="headerlink"href="#_CPPv3N4mqtt19SendDiscoveryConfig8platformE"title="Permalink to this definition">¶</a><br><dd><p>The platform of this component. Defaults to “mqtt”.</dl></div></dl></div></div></div></div></div></div><div class="sphinxsidebar"role="navigation"aria-label="main navigation"><div class="sphinxsidebarwrapper"><div class="relations"><h3>Related Topics</h3><ul><li><a href="../../index.html">Documentation overview</a><ul><li><a href="../index.html">API Reference</a><ul><li><a href="index.html">Core</a><ul><li>Previous: <a href="wifi.html"title="previous chapter">WiFi</a><li>Next: <a href="ota.html"title="next chapter">Over-The-Air Updates</a></ul></ul></ul></ul></div><div id="searchbox"style="display: none"role="search"><h3>Quick search</h3><div class="searchformwrapper"><form class="search"action="../../search.html"><input name="q"> <input type="submit"value="Go"> <input type="hidden"name="check_keywords"value="yes"> <input type="hidden"name="area"value="default"></form></div></div><script>$('#searchbox').show(0);</script></div></div><div class="clearer"></div></div><div class="footer">&copy;2018, Otto Winter. | Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a> &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a> | <a href="../../_sources/api/core/mqtt.rst.txt"rel="nofollow">Page source</a></div>