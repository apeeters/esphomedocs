
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>esphomeyaml Core Configuration &#8212; esphomelib 1.7.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="I²C Bus" href="i2c.html" />
    <link rel="prev" title="ESP32 Touch Pad Hub" href="esp32_touch.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="esphomeyaml-core-configuration">
<h1>esphomeyaml Core Configuration<a class="headerlink" href="#esphomeyaml-core-configuration" title="Permalink to this headline">¶</a></h1>
<p>Here you specify some core information that esphomeyaml needs to create
firmwares. Most importantly, this is the section of the configuration
where you specify the <strong>name</strong> of the node, the <strong>platform</strong> and
<strong>board</strong> you’re using.</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example configuration entry</span>
<span class="n">esphomeyaml</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">livingroom</span>
    <span class="n">platform</span><span class="p">:</span> <span class="n">ESP32</span>
    <span class="n">board</span><span class="p">:</span> <span class="n">nodemcu</span><span class="o">-</span><span class="mi">32</span><span class="n">s</span>
</pre></div>
</div>
<div class="section" id="configuration-variables">
<h2>Configuration variables:<a class="headerlink" href="#configuration-variables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>name</strong> (<strong>Required</strong>, string): This is the name of the node. It
should always be unique to the node and no other node in your system
can use the same name. It can also only contain upper/lowercase
characters, digits and underscores.</li>
<li><strong>platform</strong> (<strong>Required</strong>, string): The platform your board is on,
either <code class="docutils literal notranslate"><span class="pre">ESP32</span></code> or <code class="docutils literal notranslate"><span class="pre">ESP8266</span></code>. See <a class="reference internal" href="#using-latest-arduino-framework"><span class="std std-ref">Using the latest Arduino framework version</span></a>.</li>
<li><strong>board</strong> (<strong>Required</strong>, string): The board esphomeyaml should
specify for platformio. For the ESP32, choose the appropriate one
from <a class="reference external" href="http://docs.platformio.org/en/latest/platforms/espressif32.html#boards">this list</a>
and use <a class="reference external" href="http://docs.platformio.org/en/latest/platforms/espressif8266.html#boards">this list</a>
for ESP8266-based boards.</li>
</ul>
<p>Advanced options:</p>
<ul class="simple">
<li><strong>library_uri</strong> (<em>Optional</em>, string): You can manually specify the
<a class="reference external" href="https://github.com/OttoWinter/esphomelib/releases">version of esphomelib</a> to
use here. Accepts all parameters of <a class="reference external" href="http://docs.platformio.org/en/latest/userguide/lib/cmd_install.html#id2">platformio lib
install</a>.
Use <code class="docutils literal notranslate"><span class="pre">https://github.com/OttoWinter/esphomelib.git</span></code> for the latest
(unstable) build. Defaults to the latest stable version.</li>
<li><strong>simplify</strong> (<em>Optional</em>, boolean): Whether to simplify the
auto-generated code, i.e.&nbsp;whether to remove unused variables, use
<code class="docutils literal notranslate"><span class="pre">auto</span></code> types and so on. Defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</li>
<li><strong>use_build_flags</strong> (<em>Optional</em>, boolean): If esphomeyaml should manually set
build flags that specifically set what should be included in the binary. Most of
this is already done automatically by the linker but this option can help with
shrinking the firmware size while slowing down compilation. Defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</li>
<li><strong>build_path</strong> (<em>Optional</em>, string): Customize where esphomeyaml will store the build files
for your node. By default, esphomeyaml puts all platformio project files under a folder <code class="docutils literal notranslate"><span class="pre">&lt;NODE_NAME&gt;/</span></code>,
but you can customize this behavior using this option.</li>
</ul>
<p>Automations:</p>
<ul class="simple">
<li><strong>on_boot</strong> (<em>Optional</em>, <a class="reference internal" href="../guides/automations.html#automation"><span class="std std-ref">Automation</span></a>): An automation to perform
when the node starts. See <a class="reference internal" href="#esphomeyaml-on-boot"><span class="std std-ref">on_boot</span></a>.</li>
<li><strong>on_shutdown</strong> (<em>Optional</em>, <a class="reference internal" href="../guides/automations.html#automation"><span class="std std-ref">Automation</span></a>): An automation to perform
right before the node shuts down. See <a class="reference internal" href="#esphomeyaml-on-shutdown"><span class="std std-ref">on_shutdown</span></a>.</li>
</ul>
</div>
<div class="section" id="using-the-latest-arduino-framework-version">
<span id="using-latest-arduino-framework"></span><h2>Using the latest Arduino framework version<a class="headerlink" href="#using-the-latest-arduino-framework-version" title="Permalink to this headline">¶</a></h2>
<p>The default version of the arduino framework distributed through platformio is usually quite old
and the latest staging versions of the framework can in some cases increase stability a lot.</p>
<p>To use the latest version of the arduino framework with esphomeyaml, specify an URL pointing to
the staging version using the <code class="docutils literal notranslate"><span class="pre">platform:</span></code> parameter.</p>
<p>For the ESP32, this URL is <a class="reference external" href="https://github.com/platformio/platform-espressif32.git#feature/stage">https://github.com/platformio/platform-espressif32.git#feature/stage</a>.
And for the ESP8266, the URL is <a class="reference external" href="https://github.com/platformio/platform-espressif8266.git#feature/stage">https://github.com/platformio/platform-espressif8266.git#feature/stage</a>.</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example configuration entry</span>
<span class="n">esphomeyaml</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">livingroom</span>
    <span class="n">platform</span><span class="p">:</span> <span class="s1">&#39;https://github.com/platformio/platform-espressif32.git#feature/stage&#39;</span>
    <span class="n">board</span><span class="p">:</span> <span class="n">nodemcu</span><span class="o">-</span><span class="mi">32</span><span class="n">s</span>
</pre></div>
</div>
<div class="section" id="on-boot">
<span id="esphomeyaml-on-boot"></span><h3><code class="docutils literal notranslate"><span class="pre">on_boot</span></code><a class="headerlink" href="#on-boot" title="Permalink to this headline">¶</a></h3>
<p>This automation will be triggered when the ESP boots up. By default, it is executed after everything else
is already set up. You can however change this using the <code class="docutils literal notranslate"><span class="pre">priority</span></code> parameter.</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">esphomeyaml</span><span class="p">:</span>
  <span class="c1"># ...</span>
  <span class="n">on_boot</span><span class="p">:</span>
    <span class="n">priority</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span>
    <span class="c1"># ...</span>
    <span class="n">then</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">switch</span><span class="o">.</span><span class="n">turn_off</span><span class="p">:</span>
          <span class="nb">id</span><span class="p">:</span> <span class="n">switch_1</span>
</pre></div>
</div>
<p>Configuration variables:</p>
<ul class="simple">
<li><strong>priority</strong> (<em>Optional</em>, float): The priority to execute your custom initialization code. A higher value (for example
positive values) mean a high priority and thus also your code being executed earlier. So for example negative priorities
are executed very late. Defaults to <code class="docutils literal notranslate"><span class="pre">-10</span></code>. Priorities (you can use any value between them too):<ul>
<li><code class="docutils literal notranslate"><span class="pre">100</span></code>: This is where all hardware initialization of vital components is executed. For example setting switches
to their initial state.</li>
<li><code class="docutils literal notranslate"><span class="pre">10</span></code>: At this priority, WiFi is initialized.</li>
<li><code class="docutils literal notranslate"><span class="pre">7.5</span></code>: MQTT initialization takes place at this priority.</li>
<li><code class="docutils literal notranslate"><span class="pre">0.0</span></code>: This is where most sensors are set up. They are usually set up this late so that they can dump their
configuration in the MQTT logs.</li>
<li><code class="docutils literal notranslate"><span class="pre">-5.0</span></code>: The inidividual frontend counterparts for the backend components are configured at this priority</li>
<li><code class="docutils literal notranslate"><span class="pre">-10.0</span></code>: At this priority, pretty much everything should already be initialized.</li>
</ul>
</li>
<li>See <a class="reference internal" href="../guides/automations.html#automation"><span class="std std-ref">Automation</span></a>.</li>
</ul>
</div>
<div class="section" id="on-shutdown">
<span id="esphomeyaml-on-shutdown"></span><h3><code class="docutils literal notranslate"><span class="pre">on_shutdown</span></code><a class="headerlink" href="#on-shutdown" title="Permalink to this headline">¶</a></h3>
<p>This automation will be triggered when the ESP is about to shut down. Shutting down is usually caused by
too many WiFi/MQTT connection attempts, Over-The-Air updates being applied or through the <a class="reference internal" href="deep_sleep.html"><span class="doc">Deep Sleep Component</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It’s not guaranteed that all components are in a connected state when this automation is triggered. For
example, the MQTT client may have already disconnected.</p>
</div>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">esphomeyaml</span><span class="p">:</span>
  <span class="c1"># ...</span>
  <span class="n">on_shutdown</span><span class="p">:</span>
    <span class="n">then</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">switch</span><span class="o">.</span><span class="n">turn_off</span><span class="p">:</span>
          <span class="nb">id</span><span class="p">:</span> <span class="n">switch_1</span>
</pre></div>
</div>
<p>Configuration variables: See <a class="reference internal" href="../guides/automations.html#automation"><span class="std std-ref">Automation</span></a>.</p>
</div>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://github.com/OttoWinter/esphomedocs/blob/current/esphomeyaml/components/esphomeyaml.rst">Edit this page on GitHub</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">esphomeyaml</a><ul>
  <li><a href="index.html">Components</a><ul>
      <li>Previous: <a href="esp32_touch.html" title="previous chapter">ESP32 Touch Pad Hub</a></li>
      <li>Next: <a href="i2c.html" title="next chapter">I²C Bus</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Otto Winter.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/esphomeyaml/components/esphomeyaml.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>